<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kubernetes Pod Manager</title>
    <script>
        function updatePods() {
            const namespace = document.getElementById("namespace").value;
            fetch(`/list_pods/${namespace}`)
                .then(response => response.json())
                .then(data => {
                    const podList = document.getElementById("pod-list");
                    podList.innerHTML = "";
                    data.forEach(pod => {
                        const li = document.createElement("li");
                        li.innerHTML = `${pod.name} - Status: ${pod.status} <button onclick="deletePod('${namespace}', '${pod.name}')">Delete</button>`;
                        podList.appendChild(li);
                    });
                });
        }

        function deletePod(namespace, podName) {
            fetch(`/delete_pod/${namespace}/${podName}`, { method: "POST" })
                .then(response => response.json())
                .then(data => {
                    alert(data.message);
                    updatePods();
                });
        }

        setInterval(updatePods, 10000);
    </script>
</head>
<body>
    <h1>Kubernetes Pod Manager</h1>

    <form action="/create_pod" method="post">
        <h2>Create a New Pod</h2>
        <label for="namespace">Namespace:</label>
        <select id="namespace" name="namespace">
            {% for ns in namespaces %}
                <option value="{{ ns }}" {% if ns == current_namespace %}selected{% endif %}>{{ ns }}</option>
            {% endfor %}
        </select><br><br>

        <label for="gpu_request">GPU Request:</label>
        <select id="gpu_request" name="gpu_request">
            <option value="0">None</option>
            <option value="1">1 GPU</option>
        </select><br><br>

        <button type="submit">Create Pod</button>
    </form>

    <h2>Existing Pods</h2>
    <ul id="pod-list"></ul>
</body>
</html>
